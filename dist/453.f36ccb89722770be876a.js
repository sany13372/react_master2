"use strict";(self.webpackChunkreact_middle=self.webpackChunkreact_middle||[]).push([[453],{11:(e,a,r)=>{r.d(a,{I:()=>s});var n=r(7294),t=r(9457),l=r(4187);var o=r(5893);const s=(0,n.memo)((e=>{const{className:a,value:r="",onChange:n,type:s="text",placeholder:i,readonly:c,...d}=e,u={fTN1P:c};return(0,o.jsxs)(t.g,{gap:"4",max:!0,className:(0,l.A)("LuFDU",u,[a]),children:[(0,o.jsx)("div",{children:i}),(0,o.jsx)("input",{type:s,onChange:e=>{n?.(e.target.value)},className:"X8EVb",placeholder:i,value:r,readOnly:c,...d})]})}))},6453:(e,a,r)=>{r.r(a),r.d(a,{default:()=>K});var n=r(9887),t=r(6974);let l=function(e){return e.INCORRECT_USER_DATA="INCORRECT_USER_DATA",e.INCORRECT_AGE="INCORRECT_AGE",e.INCORRECT_CITY="INCORRECT_CITY",e.NO_DATA="NO_DATA",e.SERVER_ERROR="SERVER_ERROR",e}({});var o=r(7294),s=r(3942);const i=e=>e.profile?.error,c=e=>e.profile?.form,d=e=>e.profile?.isLoading,u=e=>e.profile?.readonly,C=e=>e.profile?.validateErrors;var p=r(4268);const h=(0,p.hg)("profile/fetchProfileData",(async(e,a)=>{const{extra:r,rejectWithValue:n}=a;try{const a=await r.api.get(`/profile/${e}`);if(!a.data)throw new Error;return a.data}catch(e){return console.log(e),n("error")}})),g=(0,p.hg)("profile/updateProfileData",(async(e,a)=>{const{extra:r,rejectWithValue:n,getState:t}=a,o=c(t()),s=(e=>{if(!e)return[l.NO_DATA];const{first:a,lastname:r,age:n,city:t}=e,o=[];return a&&r||o.push(l.INCORRECT_USER_DATA),(!n||n<18||n>100)&&o.push(l.INCORRECT_AGE),t||o.push(l.INCORRECT_CITY),o})(o);if(s.length)return n(s);try{const e=await r.api.put(`/profile/${o?.id}`,o);if(!e.data)throw new Error;return e.data}catch(e){return console.log(e),n([l.SERVER_ERROR])}})),m=(0,p.oM)({name:"profile",initialState:{data:void 0,isLoading:!1,readonly:!0,error:void 0},reducers:{setReadonly:(e,a)=>{e.readonly=a.payload},cancelEdit:e=>{e.readonly=!0,e.form=e.data,e.validateErrors=void 0},updateProfile:(e,a)=>{e.form={...e.form,...a.payload}}},extraReducers:e=>{e.addCase(h.pending,(e=>{e.error=void 0,e.isLoading=!0})).addCase(h.fulfilled,((e,a)=>{e.isLoading=!1,e.data=a.payload,e.form=a.payload})).addCase(h.rejected,((e,a)=>{e.isLoading=!1,e.error=a.payload})).addCase(g.pending,(e=>{e.validateErrors=void 0,e.isLoading=!0})).addCase(g.fulfilled,((e,a)=>{e.isLoading=!1,e.data=a.payload,e.form=a.payload,e.readonly=!0,e.validateErrors=void 0})).addCase(g.rejected,((e,a)=>{e.isLoading=!1,e.validateErrors=a.payload}))}}),{actions:R}=m,{reducer:v}=m,f=e=>e.profile?.data;var x=r(5321),y=r(9169),E=r(4156),N=r(9457),j=r(8699),A=r(5893);const T=e=>{let{className:a}=e;const{t:r}=(0,n.$G)("profile"),t=(0,s.v9)(f),l=(0,s.v9)(x.m5),i=t?.id===l?.id,c=(0,s.v9)(u),d=(0,y.T)(),C=(0,o.useCallback)((()=>{d(R.setReadonly(!1))}),[d]),p=(0,o.useCallback)((()=>{d(R.cancelEdit())}),[d]),h=(0,o.useCallback)((()=>{d(g())}),[d]);return(0,A.jsxs)(N.U,{justify:"between",max:!0,children:[(0,A.jsx)(j.xv,{title:r("profile page")}),i&&(0,A.jsx)(N.U,{children:c?(0,A.jsx)(E.zx,{theme:E.Wu.OUTLINE,onClick:C,children:r("edit")}):(0,A.jsxs)(N.U,{gap:"8",children:[(0,A.jsx)(E.zx,{theme:E.Wu.OUTLINE,onClick:h,children:r("Save")}),(0,A.jsx)(E.zx,{theme:E.Wu.OUTLINE_RED,onClick:p,children:r("Cancel")})]})})]})};let U=function(e){return e.Russia="Russia",e.Belarus="Belarus",e.Ukraine="Ukraine",e.Kazakhstan="Kazahstan",e.Armenia="Armenia",e}({});var k=r(4187),O=r(9607);const _=[{value:U.Armenia,content:U.Armenia},{value:U.Belarus,content:U.Belarus},{value:U.Kazakhstan,content:U.Kazakhstan},{value:U.Russia,content:U.Russia},{value:U.Ukraine,content:U.Ukraine}],I=(0,o.memo)((e=>{const{className:a,value:r,onChange:t,readonly:l,direction:s}=e,{t:i}=(0,n.$G)("translation"),c=(0,o.useCallback)((e=>{t?.(e)}),[t]);return(0,A.jsx)(O.wb,{className:(0,k.A)("",{},[a]),value:r,label:i("Country"),onChange:c,items:_,readonly:l,direction:s})}));let b=function(e){return e.RUB="RUB",e.EUR="EUR",e.USD="USD",e}({});const D=[{value:b.EUR,content:b.EUR},{value:b.RUB,content:b.RUB},{value:b.USD,content:b.USD}],L=(0,o.memo)((e=>{const{className:a,value:r,onChange:t,readonly:l,direction:s}=e,{t:i}=(0,n.$G)("translation"),c=(0,o.useCallback)((e=>{t?.(e)}),[t]);return(0,A.jsx)(O.wb,{className:(0,k.A)("",{},[a]),value:r,label:i("currency"),onChange:c,items:D,readonly:l,direction:s})}));var P=r(9960),S=r(11),w=r(5769);const G={ProfileCard:"wW9jg",editForm:"U9LGH",loading:"t07Zx",error:"i5YK3",avatarWrapper:"bEFNS"},W=e=>{const{className:a,data:r,isLoading:t,error:l,readonly:o,onChangeFirst:s,onChangeLastname:i,onChangeAge:c,onChangeCity:d,onChangeUsername:u,onChangeAvatar:C,onChangeCountry:p,onChangeCurrency:h}=e,{t:g}=(0,n.$G)("profile"),m={[G.editForm]:!o};return t?(0,A.jsx)(N.g,{max:!0,justify:"center",align:"center",className:(0,k.A)(G.ProfileCard,{},[a,G.loading]),children:(0,A.jsx)(w.a,{})}):l?(0,A.jsx)(N.g,{max:!0,className:(0,k.A)(G.ProfileCard,{},[a,G.error]),children:(0,A.jsx)(j.xv,{theme:j.lg.ERROR,title:g("profile error"),text:g("profile error text"),align:j.PH.CENTER})}):(0,A.jsxs)(N.g,{gap:"16",max:!0,className:(0,k.A)(G.ProfileCard,m,[a]),children:[r?.avatar&&(0,A.jsx)(N.U,{justify:"center",className:G.avatarWrapper,children:(0,A.jsx)(P.q,{src:r.avatar})}),(0,A.jsx)(S.I,{value:r?.first,placeholder:g("input firstname"),readonly:o,onChange:s}),(0,A.jsx)(S.I,{className:G.input,value:r?.lastname,placeholder:g("input lastname"),readonly:o,onChange:i}),(0,A.jsx)(S.I,{className:G.input,value:r?.age,placeholder:g("input age"),readonly:o,onChange:c}),(0,A.jsx)(S.I,{className:G.input,value:r?.city,placeholder:g("input city"),readonly:o,onChange:d}),(0,A.jsx)(S.I,{className:G.input,value:r?.username,placeholder:g("input username"),readonly:o,onChange:u}),(0,A.jsx)(S.I,{className:G.input,value:r?.avatar,placeholder:g("input avatar"),readonly:o,onChange:C}),(0,A.jsx)(I,{className:G.input,value:r?.country,readonly:o,onChange:p,direction:"top right"}),(0,A.jsx)(L,{className:G.input,value:r?.currency,readonly:o,onChange:h,direction:"top right"})]})};var B=r(8205),$=r(9728);const z={profile:v},V=(0,o.memo)((e=>{const{className:a,id:r}=e,{t}=(0,n.$G)("profile"),p=(0,y.T)(),g=(0,s.v9)(c),m=(0,s.v9)(d),v=(0,s.v9)(i),f=(0,s.v9)(u),x=(0,s.v9)(C);(0,$.Q)((()=>{r&&p(h(r))}));const E={[l.INCORRECT_AGE]:t("incorrect age"),[l.INCORRECT_CITY]:t("incorrect  city"),[l.INCORRECT_USER_DATA]:t("incorrect user data"),[l.NO_DATA]:t("incorrect data"),[l.SERVER_ERROR]:t("incorrect server error")},U=(0,o.useCallback)((e=>{p(R.updateProfile({first:e||""}))}),[p]),O=(0,o.useCallback)((e=>{p(R.updateProfile({lastname:e||""}))}),[p]),_=(0,o.useCallback)((e=>{p(R.updateProfile({age:Number(e?.replace(/\D/gi,"")||0)}))}),[p]),I=(0,o.useCallback)((e=>{p(R.updateProfile({city:e||""}))}),[p]),b=(0,o.useCallback)((e=>{p(R.updateProfile({username:e||""}))}),[p]),D=(0,o.useCallback)((e=>{p(R.updateProfile({avatar:e||""}))}),[p]),L=(0,o.useCallback)((e=>{p(R.updateProfile({currency:e}))}),[p]),P=(0,o.useCallback)((e=>{p(R.updateProfile({country:e}))}),[p]);return(0,A.jsx)(B.W,{reducers:z,children:(0,A.jsxs)(N.g,{gap:"16",max:!0,className:(0,k.A)("",{},[a]),children:[(0,A.jsx)(T,{}),x?.length&&x.map((e=>(0,A.jsx)(j.xv,{theme:j.lg.ERROR,text:E[e]},e))),(0,A.jsx)(W,{data:g,isLoading:m,error:v,readonly:f,onChangeFirst:U,onChangeLastname:O,onChangeAge:_,onChangeCity:I,onChangeUsername:b,onChangeAvatar:D,onChangeCurrency:L,onChangeCountry:P})]})})}));var F=r(3468);const K=e=>{let{className:a}=e;const{t:r}=(0,n.$G)("profile"),{id:l}=(0,t.UO)();return l?(0,A.jsx)(F.T,{className:(0,k.A)("",{},[a]),children:(0,A.jsx)(N.g,{gap:"16",children:(0,A.jsx)(V,{id:l})})}):(0,A.jsx)(j.xv,{text:r("profile not found")})}}}]);